<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script type="text/javascript" src="http://use.typekit.net/bsa5hge.js"></script>
        <script type="text/javascript">
        try {
            Typekit.load();
        } catch(e) {}
        </script>

        <script src="/-assets/javascripts/vendor/modernizr.js"></script>

        <link rel="stylesheet" href="/-assets/stylesheets/vendor.css">
        <link rel="stylesheet" href="/-assets/stylesheets/user.css">

        <title>PlaceTime - Timeline</title>
    </head>
    <body>


        <div class="layout-header"></div>
        <div class="layout-content"></div>




        <script type="text/template" id="item-template">
            <div class="overlay"></div>

            <p class="sash event">
                <i class="icon-calendar"></i>
            </p>
            <p class="sash event-added">
                <i class="icon-calendar"></i>
            </p>
            <p class="sash video">
                <i class="icon-facetime-video"></i>
            </p>
            <p class="sash audio">
                <i class="icon-headphones"></i>
            </p>
            <p class="sash text">
                <i class="icon-file-alt"></i>
            </p>
            <p class="sash added">
                <span>
                    Added to playlist
                    <i class="icon-plus"></i>
                </span>
            </p>
            <p class="sash flagged">
                <span>
                    Flagged
                    <i class="icon-flag"></i>
                </span>
            </p>

            <div class="icon pull-left">
                <% if (author.profileimageurlhttps) { %>
                    <img src="<%= author.profileimageurlhttps %>" width="40" height="40" />
                <% } else { %>
                    <img src="/-assets/images/user.png" width="40" height="40" />
                <% } %>
            </div>
            <p class="username username-item pull-left">
                <a href="#user/<%= encodeURI(author.pid) %>">
                    <%= author.pid %>
                </a>
            </p>


            <% if (media === 'video') { %>
                <p class="item-text pull-left">
                    <% if (isYoutube(link) === true) { %>
                        <a class="fancybox fancybox.iframe" href="<%= getYoutubeUrl(link) %>">
                            <i class="icon-play-circle"></i>
                            <%= text %>
                        </a>
                    <% } else { %>
                        <a class="fancybox fancybox.iframe" href="<%= link %>">
                            <i class="icon-play-circle"></i>
                            <%= text %>
                        </a>
                    <% } %>
                </p>
            <% } else if (media === 'audio') { %>
                <p class="item-text pull-left">
                    <% if (isSpotify(link) === true) { %>
                        <a class="audio" href="<%= getSpotifyUrl(link) %>">
                            <i class="icon-play-circle"></i>
                            <%= text %>
                        </a>
                    <% } else { %>
                        <a class="audio" href="<%= link %>">
                            <i class="icon-play-circle"></i>
                            <%= text %>
                        </a>
                    <% } %>
                </p>
            <% } else { %>
                <p class="item-text pull-left">
                    <a class="fancybox fancybox.iframe" href="<%= link %>">
                        <i class="icon-external-link"></i>
                        <%= text %>
                    </a>
                </p>
            <% } %>

            <% if (duration !== undefined && duration !== 0) { %>
                <% duration = getDuration(duration) %>
                <ul class="item-duration duration pull-left">
                    <% if (duration.days !== 0) { %>
                    <li class="days"><%= duration.days %>d</li>
                    <% } %>

                    <% if (duration.days !== 0 && duration.hours !== 0) { %>
                    <li class="durationcolon">:</li>
                    <% } %>

                    <% if (duration.hours !== 0) { %>
                    <li class="hours"><%= duration.hours %>h</li>
                    <% } %>

                    <% if (duration.hours !== 0 && duration.minutes !== 0) { %>
                    <li class="durationcolon">:</li>
                    <% } %>

                    <% if (duration.minutes !== 0) { %>
                    <li class="minutes"><%= duration.minutes %>m</li>
                    <% } %>

                    <% if (duration.minutes !== 0 && duration.seconds !== 0) { %>
                    <li class="durationcolon">:</li>
                    <% } %>

                    <% if (duration.seconds !== 0) { %>
                    <li class="seconds"><%= duration.seconds %>s</li>
                    <% } %>
                </ul>
            <% } %>

            <% if (via !== undefined) { %>
                <p class="via pull-left">
                    <a href="#user/<%= via.pid %>">
                        copied by <%= via.name %>
                    </a>
                </p>
            <% } %>

            <p class="time pull-left">
                <a class="fancybox fancybox.iframe" href="<%= link %>">
                    <% if (hasEvent(event) === true) { %>
                        <i class="icon-calendar"></i> <span class="event">event:</span>
                        <span class="timestamp"><%= moment.unix(event).fromNow() %></span>
                    <% } else { %>
                        <i class="icon-time"></i> <span class="added">added:</span>
                        <span class="timestamp"><%= time(ts, event, added).fromNow() %></span>
                    <% } %>
                    <a class="item-url" href="<%= url(id) %>">link</span>
                </a>
            </p>

            <% if (Application.session.get('pid') === user && status !== 'p') { %>
                <a class="button button-demote">
                    <i class="icon-remove"></i>
                </a>
            <% } else { %>
                <a class="button button-promote">
                    <i class="icon-ok"></i>
                </a>
            <% } %>
        </script>


        <script type="text/template" id="item-add-template">
            <form class="form item-add-form">
                <div class="field item-add-media">
                    <label for="watch">
                        <input type="radio" name="media" value="video" id="watch" checked="checked">
                        Watch
                    </label>
                    <label for="listen">
                        <input type="radio" name="media" value="audio" id="listen">
                        Listen
                    </label>
                    <label for="do">
                        <input type="radio" name="media" value="event" id="do">
                        Do
                    </label>
                    <label for="read">
                        <input type="radio" name="media" value="text" id="read">
                        Read
                    </label>
                </div>

                <div class="field item-add-title">
                    <input type="text" name="text" placeholder="Title" value="<%= text %>">
                </div>

                <div class="field item-add-image">
                    <div class="item-add-image-placeholder">
                        <img src="/-assets/images/loading-image.gif" height="16" width="16" />

                        <% if (duration !== undefined && duration !== 0) { %>
                            <% duration = getDuration(duration) %>
                            <ul class="item-add-duration duration">
                                <% if (duration.days !== 0) { %>
                                <li class="days"><%= duration.days %>d</li>
                                <% } %>

                                <% if (duration.days !== 0 && duration.hours !== 0) { %>
                                <li class="durationcolon">:</li>
                                <% } %>

                                <% if (duration.hours !== 0) { %>
                                <li class="hours"><%= duration.hours %>h</li>
                                <% } %>

                                <% if (duration.hours !== 0 && duration.minutes !== 0) { %>
                                <li class="durationcolon">:</li>
                                <% } %>

                                <% if (duration.minutes !== 0) { %>
                                <li class="minutes"><%= duration.minutes %>m</li>
                                <% } %>

                                <% if (duration.minutes !== 0 && duration.seconds !== 0) { %>
                                <li class="durationcolon">:</li>
                                <% } %>

                                <% if (duration.seconds !== 0) { %>
                                <li class="seconds"><%= duration.seconds %>s</li>
                                <% } %>
                            </ul>
                        <% } %>
                    </div>
                </div>

                <div class="field item-add-event">
                    <label for="event">
                        Add event or schedule date:
                        <input type="checkbox" name="event" id="event">
                    </label>
                </div>

                <div class="field item-add-ets">
                    <label for="ets">Event Date</label>
                    <input type="date" placeholder="dd/mm/yyyy" min="1900-00-00" name="ets" value="<%= ets %>">
                </div>

                <div class="actions">
                    <input type="hidden" name="duration" value="<%= duration %>">

                    <input type="submit" value="Add" class="item-add-btn-add">
                    <input type="submit" value="Cancel" class="item-add-btn-cancel">
                </div>
            </form>
        </script>


        <script type="text/template" id="item-empty-template">
            <p>
                <% if (loading === true) { %>
                    <span>Loading results</span>
                    <img alt="Loading" class="loading" src="/-assets/images/vendor/jquery/fancybox/fancybox_loading.gif" height="24" width="24" />
                <% } else { %>
                    <% if (Application.session.get('pid') === user) { %>
                        <% if (status === 'p') { %>
                            There are no items in your timeline, search for users to follow
                        <% } else { %>
                            Add a new item or copy one from your timeline
                        <% } %>
                    <% } else { %>
                        There are no items in <%= user %> timeline
                    <% } %>
                <% } %>
            </p>
        </script>



        <script type="text/template" id="following-template">
            <p class="sash unfollowed">
                <span>
                    Unfollowed
                    <i class="icon-minus"></i>
                </span>
            </p>
            <p class="sash flagged">
                <span>
                    Flagged
                    <i class="icon-flag"></i>
                </span>
            </p>


            <div class="icon icon-profile pull-left">
                <% if (profileimageurl) { %>
                    <img src="<%= profileimageurl %>" width="40" height="40" />
                <% } else { %>
                    <img src="/-assets/images/user.png" width="40" height="40" />
                <% } %>
            </div>

            <p class="username username-profile pull-left">
                <a href="#user/<%= encodeURI(pid) %>">
                    <%= pid %>
                    <i class="icon-flag flag" title="Flag profile for spam"></i>
                </a>
            </p>

            <% if (bio) { %>
            <p class="bio pull-left">
                <% if (name) { %>
                    <span class="name"><%= name %></span>:
                <% } %>

                <%= bio %>
            </p>
            <% } %>

            <ul class="statistics pull-left">
                <li class="followings">
                    <a href="#followings/<%= pid %>"><%= followingcount %> following</a>
                </li>
                <li class='followers'>
                    <a href="#followers/<%= pid %>"><%= followercount %> followers</a>
                </li>
            </ul>

            <% if (Application.session.get('pid') === user) { %>
                <a class="button button-unfollow">
                    <i class="icon-minus"></i>
                </a>
            <% } %>
        </script>


        <script type="template/text" id="timeline-public-header-template">
            <ul class="timeline-nav pull-left">
                <li class="items first <%= (view == 'timeline')? 'active':'' %>">
                    <a href="#timeline">Timeline</a>
                </li>
                <li class="followings <%= (view == 'followings')? 'active':'' %>">
                    <a href="#followings">Following</a>
                </li>
                <li class="followers last <%= (view == 'followers')? 'active':'' %>">
                    <a href="#followers">Followers</a>
                </li>
            </ul>


            <form class="form">
                <select class="pull-left type" name="t">
                    <% if (type === 'v') { %>
                        <option value="v" selected="selected">Watch</option>
                    <% } else { %>
                        <option value="v">Watch</option>
                    <% } %>

                    <% if (type === 'a') { %>
                        <option value="a" selected="selected">Listen</option>
                    <% } else { %>
                        <option value="a">Listen</option>
                    <% } %>

                    <% if (type === 'e') { %>
                        <option value="e" selected="selected">Do</option>
                    <% } else { %>
                        <option value="e">Do</option>
                    <% } %>

                    <% if (view === 'followings' || view === 'followers') { %>
                        <option value="p" selected="selected">People</option>
                    <% } else if (type === 'p') { %>
                        <option value="p" selected="selected">People</option>
                    <% } else { %>
                        <option value="p">People</option>
                    <% } %>
                </select>

                <input class="pull-left search" name="s" type="search" placeholder="<%= placeholders[type] %>" value="<%= search %>" required="required">
            </form>
            <% if (view === 'timeline') { %>
            <a class="now pull-right">
                now <i class="icon-now icon-repeat"></i>
            </a>
            <% } else if (view === 'search') { %>
            <a class="back pull-right" href="#timeline">
                back <i class="icon-back icon-arrow-left"></i>
            </a>
            <% } %>
        </script>



        <script type="text/template" id="search-item-template">
            <div class="overlay"></div>

            <p class="sash event">
                <i class="icon-calendar"></i>
            </p>
            <p class="sash event-added">
                <i class="icon-calendar"></i>
            </p>
            <p class="sash video">
                <i class="icon-facetime-video"></i>
            </p>
            <p class="sash audio">
                <i class="icon-headphones"></i>
            </p>
            <p class="sash text">
                <i class="icon-file-alt"></i>
            </p>
            <p class="sash added">
                <span>
                    Added to playlist
                    <i class="icon-plus"></i>
                </span>
            </p>
            <p class="sash flagged">
                <span>
                    Flagged
                    <i class="icon-flag"></i>
                </span>
            </p>


            <div class="icon pull-left">
                <% if (author.profileimageurlhttps) { %>
                    <img src="<%= author.profileimageurlhttps %>" width="40" height="40" />
                <% } else { %>
                    <img src="/-assets/images/user.png" width="40" height="40" />
                <% } %>
            </div>
            <p class="username username-item pull-left">
                <a href="#user/<%= encodeURI(author.pid) %>">
                    <%= author.pid %>
                </a>
            </p>


            <% if (media === 'video') { %>
                <p class="item-text pull-left">
                    <% if (isYoutube(link) === true) { %>
                        <a class="fancybox fancybox.iframe" href="<%= getYoutubeUrl(link) %>">
                            <i class="icon-play-circle"></i>
                            <%= text %>
                        </a>
                    <% } else { %>
                        <a class="fancybox fancybox.iframe" href="<%= link %>">
                            <i class="icon-play-circle"></i>
                            <%= text %>
                        </a>
                    <% } %>
                </p>
            <% } else if (media === 'audio') { %>
                <p class="item-text pull-left">
                    <% if (isSpotify(link) === true) { %>
                        <a class="audio" href="<%= getSpotifyUrl(link) %>">
                            <i class="icon-play-circle"></i>
                            <%= text %>
                        </a>
                    <% } else { %>
                        <a class="audio" href="<%= link %>">
                            <i class="icon-play-circle"></i>
                            <%= text %>
                        </a>
                    <% } %>
                </p>
            <% } else { %>
                <p class="item-text pull-left">
                    <a class="fancybox fancybox.iframe" href="<%= link %>">
                        <i class="icon-external-link"></i>
                        <%= text %>
                    </a>
                </p>
            <% } %>

            <% if (duration !== undefined && duration !== 0) { %>
                <% duration = getDuration(duration) %>
                <ul class="item-duration duration pull-left">
                    <% if (duration.days !== 0) { %>
                    <li class="days"><%= duration.days %>d</li>
                    <% } %>

                    <% if (duration.days !== 0 && duration.hours !== 0) { %>
                    <li class="durationcolon">:</li>
                    <% } %>

                    <% if (duration.hours !== 0) { %>
                    <li class="hours"><%= duration.hours %>h</li>
                    <% } %>

                    <% if (duration.hours !== 0 && duration.minutes !== 0) { %>
                    <li class="durationcolon">:</li>
                    <% } %>

                    <% if (duration.minutes !== 0) { %>
                    <li class="minutes"><%= duration.minutes %>m</li>
                    <% } %>

                    <% if (duration.minutes !== 0 && duration.seconds !== 0) { %>
                    <li class="durationcolon">:</li>
                    <% } %>

                    <% if (duration.seconds !== 0) { %>
                    <li class="seconds"><%= duration.seconds %>s</li>
                    <% } %>
                </ul>
            <% } %>


            <% if (via !== undefined) { %>
                <p class="via pull-left">
                    <a href="#user/<%= via.pid %>">
                        copied by <%= via.name %>
                    </a>
                </p>
            <% } %>

            <% if (media !== 'video' && media !== 'audio') { %>
                <p class="time pull-left">
                    <a class="fancybox fancybox.iframe" href="<%= link %>">
                        <% if (hasEvent(event) === true) { %>
                            <i class="icon-calendar"></i> <span class="event">event:</span>
                            <span class="timestamp"><%= moment.unix(event).fromNow() %></span>
                        <% } else { %>
                            <i class="icon-time"></i> <span class="added">added:</span>
                            <span class="timestamp"><%= time(ts, event, added).fromNow() %></span>
                        <% } %>
                        <a class="item-url" href="<%= url(id) %>">link</span>
                    </a>
                </p>
            <% } %>

            <a class="button button-add">
                <i class="icon-ok"></i>
            </a>
        </script>

        <script src="/-assets/javascripts/vendor.js"></script>
        <script src="/-assets/javascripts/templates.js"></script>
        <script src="/-assets/javascripts/application.js"></script>

        <script type="text/javascript">
        Application.start({
            router: 'user'
        });
        </script>
    </body>
</html>
